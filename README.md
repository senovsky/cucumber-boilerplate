# Automated regression tests

This repository contains automated regression tests. Based on [boilerplate](https://github.com/webdriverio/cucumber-boilerplate) to run WebdriverIO tests with [Cucumber](https://cucumber.io/). Instead of writing complicated test code that only developers can understand, Cucumber uses an ordinary language to describe the steps of the E2E tests.

## Test scenarios

Test scenarios are specified in the `features` folder. Variables denoted by double underscore can be used. They have to be defined in `pageObjects.json` using a key:value pair.
The `.feature` files are parsed before each tests run using the command `node parser.js && wdio` used as a `test` script defined in `package.json`. This script is run by the `e2e:jenkins` script defined in the root folder's `package.json`.
Step definitions (Gherkin steps) are specified in the `steps` folder. They are calling functions specified in the `support` folder.
All the step definitions should be written in a way that allows the step to be used in more than one scenario (i.e. no scenario-specific steps).

## Requirements

- Node.js LTS, including npm ([NVM](https://github.com/coreybutler/nvm-windows) recommended)
- Selenium server running at http://localhost:4444/wd/hub with chromedriver and Chrome. Can be [dockerized](https://robotninja.com/blog/introduction-using-selenium-docker-containers-end-end-testing/)
- Allure Jenkins plugin installed and configured using this [guide](https://docs.qameta.io/allure/#_jenkins) to display test results generated by [WDIO Allure Reporter](https://webdriver.io/docs/allure-reporter.html)
- Slack Notifications Jenkins plugin installed and configured using this [guide](https://medium.com/appgambit/integrating-jenkins-with-slack-notifications-4f14d1ce9c7a)

## Jenkinsfile

In the root folder, the `Jenkinsfile` contains stage `e2e-tests`. It enables the tests to run automatically on a server and create a report.

## Local installation & test run

Clone this repository. Make sure Selenium server is running, for example by running:

```
npm i -g webdriver-manager && webdriver-manager update --chrome && webdriver-manager start
```

Then run those commands:

```
npm install
```

```
npm test
```

Allure test report can be displayed using [Allure Commandline](https://www.npmjs.com/package/allure-commandline) by command:

```
allure generate _results_/allure-raw --clean && allure open
```

## View reports

- The terminal shows progress in detail
- Allure results are generated during the test run into the `_results_` folder
- slackSend sends a message to Slack based on `tokenCredentialId`

# Risks and mitigations

- The selectors of elements used in the test scenarios might stop working (in case the implementation of said elements changes).
    - The test engineer has to update the selectors.

- The tests rely on certain data being present in the test database.
    - If the data in the database change, the test engineer has to update the tests accordingly.

- The tests also rely on certain data *not* being present in the test database.
    - It is necessary to choose data which are very unlikely to already exist. If the tests fail, it's also necessary to make sure that the data wasn't left over from the previous test run (i.e. their deletion failed).

- The password of the account used in the tests might expire.
    - The test engineer has to update the password after creating a new one. In case a separate test account was created, it could have a non-expiring password.

- The tests are only run with Admin permissioned account. Therefore, test scenarios with lower level of permission are missing.
    - It would be good to add tests which make sure that Employee can't access admin-only features.

# Contribute
Contact:

Nikola Šenovský - Test Engineer | senovsky@gmail.com | github.com/senovsky
